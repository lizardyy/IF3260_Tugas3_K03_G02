<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/bd3cec54b7.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
    <title>WEBGL 3D</title>
</head>
<body>
        <html>
        <script id="vertex-shader" type="x-shader/x-vertex">
                precision mediump float;
                attribute vec3 vPosition;
                attribute vec3 aNormal;
                attribute vec3 vColor;
                varying vec3 fColor;

                uniform mat4 mWorld;
                uniform mat4 mView;
                uniform mat4 mProj;

                uniform vec3 uLightDirection;
                varying vec3 vNormal;

                varying vec3 vWorldPosition;
                varying vec3 vWorldNormal;

                uniform bool shading;
                uniform bool customMapping;
                uniform bool bumpMapping;
                uniform bool reflectiveMapping;
                void main(){
                    float intensity = max(dot(normalize(vPosition), uLightDirection), 0.0);
                    if(shading) {
                        fColor = vec3(vColor.rgb * intensity);
                    }
                    else {
                        fColor = vec3(vColor.rgb);
                    }
                    gl_Position = mProj * mView * mWorld * vec4(vPosition, 1.0);
                    vNormal = normalize(vPosition.xyz);
                    vWorldPosition = (mWorld * vec4(vPosition, 1.0)).xyz;
                    vWorldNormal = mat3(mWorld) * aNormal;
                }
        </script>
        <script id="fragment-shader" type="x-shader/x-fragment">
        
                precision mediump float;
                varying vec3 fColor;
                varying vec3 vNormal;
                uniform samplerCube uTexture;

                varying vec3 vWorldPosition;
                varying vec3 vWorldNormal;

                uniform vec3 uWorldCameraPosition;
                uniform bool shading;
                uniform bool customMapping;
                uniform bool bumpMapping;
                uniform bool reflectiveMapping;
                void main(){
                    vec3 worldNormal = normalize(vWorldNormal);
                    vec3 eyeToSurfaceDir = normalize(vWorldPosition - uWorldCameraPosition);
                    vec3 direction = reflect(eyeToSurfaceDir, worldNormal);
                    if(customMapping) {
                        gl_FragColor = textureCube(uTexture, normalize(vNormal));
                    }
                    else if(bumpMapping) {
                        
                    }
                    else if(reflectiveMapping) {
                        gl_FragColor = textureCube(uTexture, direction);
                    }
                    else {
                        gl_FragColor = vec4(fColor.rgb, 1.0);
                    }
                    
                }
                </script>
        
        </html>
    <div class="wrapper">
        <h1 id="web_title">WEBGL 3D</h1>
        <hr>
        <div class="row" id="side-row">
            <div class="col-center">
                <p style="color: white; font-weight:500">Shading</p>
                <label class="toggle-switch">
                    <input type="checkbox" id="shading" value="shading" checked>
                    <span class="slider"></span>
                </label>
                <p style="color: white; font-weight:500">Animation</p>
                <label class="toggle-switch">
                    <input type="checkbox" id="animation" value="animation" checked>
                    <span class="slider"></span>
                </label>
                <p style="color: white; font-weight:500 back">Component Tree</p>
                <div id="component-tree"></div>
            </div>
            <canvas id="canvas" width="1200" height="600"></canvas>
            <div class="col-center">
                <div class="color">
                    <p style="color: white; font-weight:500">Color</p>
                    <input type="color" id="color-picker" name="color-picker" value="#331A66">
                </div>
                <button class="button_func text" id="reset-draw" onclick="resetCameraView()">Reset</button>
                <button class="button_func text" id="upload-button">Upload</button>
                <button class="button_func text" id="save-button" onclick="saveModel()">Save</button>
                <input type="file" id="file-input" onchange="loadModel()" style="display:none">
                <a class="helplink" href="help.html" target="_blank"><button class="button_func text" id="help-button" >Help</button></a>
            </div>
        </div>
        <div class="row" id="full-row">
            <button class="button_func" id="projection-btn" onclick="toggleDropdown('projection-form')">
                <i class="fa-solid fa-video"></i>
            </button>
            <div class="dropdown" id="projection-form">
                <div class="dropdown-content">
                    <form>
                        <input type="radio" id="orthographic" name="radio-group" onclick="changeProjection('orthographic')">
                        <label for="orthographic" class="radio-label">Orthographic</label><br>     
                        
                        <input type="radio" id="oblique" name="radio-group" onclick="changeProjection('oblique')">
                        <label for="oblique" class="radio-label">Oblique</label><br>     

                        <input type="radio" id="perspective" name="radio-group" onclick="changeProjection('perspective')">
                        <label for="perspective" class="radio-label">Perspective</label>    
                    </form>
                </div>
            </div>

            <button class="button_func" id="rotate-btn" onclick="toggleDropdown('rotate-form')">
                <i class="fa-solid fa-rotate"></i>
            </button>
            <div class="dropdown" id="rotate-form">
                <div class="dropdown-content">
                    <form>
                        <label for="x-rotate">X Rotation:</label>
                        <p class="range-value" id="x-rotation-value">0째</p>
                        <input type="range" id="x-rotation" name="x-rotation" min="0" max="360" value="0" oninput="rotateModel(0,this.value)" required >
                        <br>
                        
                        <label for="y-rotate">Y Rotation:</label>
                        <p class="range-value" id="y-rotation-value">0째</p>
                        <input type="range" id="y-rotation" name="y-rotation" min="0" max="360" value="0" oninput="rotateModel(1,this.value)" required>
                        <br>

                        <label for="z-rotate">Z Rotation:</label>
                        <p class="range-value" id="z-rotation-value">0째</p>
                        <input type="range" id="z-rotation" name="z-rotation" min="0" max="360" value="0"  oninput="rotateModel(2,this.value)" required>
                        <br>

                        <label for="part-rotate" id="part-rotate-label">Part Rotation:</label>
                        <p class="range-value" id="part-rotation-value">0째</p>
                        <input type="range" id="part-rotation" name="part-rotation" min="0" max="360" value="0"  oninput="rotateModel(3,this.value)" required>
                    </form>
                </div>
            </div>

            <button class="button_func" id="scale-btn" onclick="toggleDropdown('scale-form')">
                <i class="fa-solid fa-arrows-left-right"></i>
            </button>
            <div class="dropdown" id="scale-form">
                <div class="dropdown-content">
                    <form>
                        <label for="x-scale">X Scale:</label>
                        <p class="range-value" id="x-scale-value">1</p>
                        <input type="range" id="x-scale" name="x-scale" min="0" max="2" step="0.05" value="1" oninput="scaleModel(0,this.value)" required>
                        <br>
                        
                        <label for="y-scale">Y Scale:</label>
                        <p class="range-value" id="y-scale-value">1</p>
                        <input type="range" id="y-scale" name="y-scale" min="0" max="2" step="0.05" value="1" oninput="scaleModel(1,this.value)" required>
                        <br>

                        <label for="z-scale">Z Scale:</label>
                        <p class="range-value" id="z-scale-value">1</p>
                        <input type="range" id="z-scale" name="z-scale" min="0" max="2" step="0.05" value="1" oninput="scaleModel(2,this.value)" required>
                    </form>
                </div>
            </div>

            <button class="button_func" id="translate-btn" onclick="toggleDropdown('translate-form')">
                <i class="fa-solid fa-up-down-left-right"></i>
            </button>
            <div class="dropdown" id="translate-form">
                <div class="dropdown-content">
                    <form>
                        <label for="x-translate">X Translation:</label>
                        <p class="range-value" id="x-translate-value">0</p>
                        <input type="range" id="x-translate" name="x-translate" min="-2" max="2" step="0.05" value="0" oninput="translateModel(0,this.value)" required>
                        <br>
                        
                        <label for="y-translate">Y Translation:</label>
                        <p class="range-value" id="y-translate-value">0</p>
                        <input type="range" id="y-translate" name="y-translate" min="-2" max="2" step="0.05" value="0" oninput="translateModel(1,this.value)" required>
                        <br>

                        <label for="z-translate">Z Translation:</label>
                        <p class="range-value" id="z-translate-value">0</p>
                        <input type="range" id="z-translate" name="z-translate" min="-2" max="2" step="0.05" value="0" oninput="translateModel(2,this.value)" required>
                    </form>
                </div>
            </div>

            <button class="button_func" id="camera-btn" onclick="toggleDropdown('camera-form')">
                <i class="fa-solid fa-camera"></i>
            </button>
            <div class="dropdown" id="camera-form">
                <div class="dropdown-content">
                    <form>
                        <label for="angle-camera">Angle:</label>
                        <p class="range-value" id="angle-camera-value">0째</p>
                        <input type="range" id="angle-camera" name="angle-camera" min="0" max="360" value="0" oninput="changeAngle(this.value)" required>
                        <br>
                        
                        <label for="radius-camera">Radius:</label>
                        <p class="range-value" id="radius-camera-value">5</p>
                        <input type="range" id="radius-camera" name="radius-camera" min="0" max="105" step="0.05" value="5" oninput="changeRadius(this.value)" required>
                    </form>
                </div>
            </div>

            <button class="button_func" id="texture-btn" onclick="toggleDropdown('texture-form')">
                Txtr
            </button>
            <div class="dropdown" id="texture-form">
                <div class="dropdown-content">
                    <form>
                        <input type="radio" id="bump" name="radio-group" onclick="changeMapping('bump')">
                        <label for="bump" class="radio-label">Bump</label><br>     
                        
                        <input type="radio" id="reflective" name="radio-group" onclick="changeMapping('reflective')">
                        <label for="reflective" class="radio-label">Reflective</label><br>     

                        <input type="radio" id="custom" name="radio-group" onclick="changeMapping('custom')">
                        <label for="custom" class="radio-label">Custom</label>    
                    </form>
                </div>
            </div>
            <button class="button_func" id="light-btn" onclick="toggleDropdown('light-form')">
                <i class="fa-solid fa-sun"></i>
            </button>
            <div class="dropdown" id="light-form">
                <div class="dropdown-content">
                    <form>
                        <label for="light-x">Light x</label>
                        <p class="range-value" id="light-x-value">0</p>
                        <input type="range" id="light-x" name="light-x" min="-1" max="1" step="0.05" value="1" oninput="changeLightDirection(0, this.value)">
                        <br>
                        <label for="light-y">Light y</label>
                        <p class="range-value" id="light-y-value">0</p>
                        <input type="range" id="light-y" name="light-y" min="-1" max="1" step="0.05" value="1" oninput="changeLightDirection(1, this.value)">
                        <br>
                        <label for="light-z">Light z</label>
                        <p class="range-value" id="light-z-value">0</p>
                        <input type="range" id="light-z" name="light-z" min="-1" max="1" step="0.05" value="1" oninput="changeLightDirection(2, this.value)">
                        
                    </form>
                </div>
            </div>
        </div>
        <!-- <div class="row" id="full-row">
            
            
            <div class="col-center">
                <h2 style="color: white; font-weight:500">Component Control</h2>
                <div id="component-control"></div>
            </div>
        </div> -->
        
    </div>
    <script type="text/javascript" src="matrix.js"></script>
    <script type="text/javascript" src="utils.js"></script>
    <script type="text/javascript" src="articulated.js"></script>
    <script type="text/javascript" src="model.js"></script>
    <script type="text/javascript" src="transformation.js"></script>
    <script type="text/javascript" src="script.js"></script>
</body>
</html>